# --- [1. ê³µí†µ ì„¤ì • (ëª¨ë“  í™˜ê²½ ì ìš©)] ---
spring:
  application:
    name: backend
# =====================ì»¤ë®¤ë‹ˆí‹°===============================
    # íŒŒì¼ ì—…ë¡œë“œ ìš©ëŸ‰ ì„¤ì • 
  servlet:
    multipart:
      max-file-size: 80MB       # íŒŒì¼ í•˜ë‚˜ë‹¹ ìµœëŒ€ í¬ê¸° (ê¸°ë³¸ 1MB)
      max-request-size: 80MB    # í•œ ë²ˆ ìš”ì²­ì˜ ì „ì²´ í¬ê¸° (ê¸°ë³¸ 10MB)
# ============================================================
  
  # i18n ë©”ì‹œì§€ ì„¤ì •
  messages:
    basename: messages/messages
    encoding: UTF-8

  jpa:
    open-in-view: false
    properties:
      hibernate:
        format_sql: true
  
  # Flyway ì„¤ì •
  flyway:
    enabled: true
    baseline-on-migrate: true
    out-of-order: true # ë§ˆì´ê·¸ë ˆì´ì…˜ ìˆœì„œ ìœ ì—°í•˜ê²Œ í—ˆìš©
    clean-disabled: false # [ìœ„í—˜] DB ì´ˆê¸°í™” ê¸°ëŠ¥ í™œì„±í™” (ê°œë°œ ë‹¨ê³„ë¼ í—ˆìš©)
    clean-on-validation-error: true # ì²´í¬ì„¬ ë¶ˆì¼ì¹˜ ì‹œ ìë™ìœ¼ë¡œ DB ë‚ ë¦¬ê³  ë‹¤ì‹œ ì‹œì‘

  # Mail (common defaults)
  mail:
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:1025}
    username: ${SMTP_USER:}
    password: ${SMTP_PASS:}
    properties:
      mail:
        smtp:
          auth: ${SMTP_AUTH:false}
          starttls:
            enable: ${SMTP_STARTTLS:false}
            required: ${SMTP_STARTTLS_REQUIRED:false}

  # â˜…â˜…â˜… [ì´ë™ë¨] AWS S3 ì„¤ì • (ëª¨ë“  í™˜ê²½ì—ì„œ ì‚¬ìš©) â˜…â˜…â˜…
  cloud:
    aws:
      credentials:
        access-key: ${AWS_ACCESS_KEY_ID}
        secret-key: ${AWS_SECRET_ACCESS_KEY}
      region:
        static: ap-northeast-2
      s3:
        bucket: teamlms-bucket # ë³¸ì¸ ë²„í‚·ëª… í™•ì¸ í•„ìˆ˜
  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
      chat:
        options:
          model: gpt-4o-mini
          temperature: 0.7
          max-tokens: 256

# ğŸ” JWT ê³µí†µ ì„¤ì •
security:
  jwt:
    secret: ${JWT_SECRET:THIS_IS_A_LONG_SECRET_KEY_FOR_JWT_32_CHARS_MIN}
    access-token-seconds: 3600
    
logging:
  level:
    org.springframework.security: DEBUG

---
# --- [2. ë¡œì»¬ ê°œë°œ í™˜ê²½ (ë‚´ ì»´í“¨í„°)] ---
spring:
  config:
    activate:
      on-profile: local
  
  datasource:
    url: jdbc:postgresql://localhost:5432/team_lms
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver
  
  jpa:
    hibernate:
      ddl-auto: validate 
    show-sql: true

---
# --- [3. ë°°í¬ í™˜ê²½ (EC2 + RDS)] ---
spring:
  config:
    activate:
      on-profile: prod
  
  datasource:
    url: jdbc:postgresql://${RDS_ENDPOINT}:5432/postgres
    username: ${DB_USER}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false

# [ê¸°íƒ€ ì„¤ì •]
api:
worknet:
  key: "h3Fc15RT7IE4WhljLA0kr4FiYG7SBGdR"
  base-url: "http://openapi.work.go.kr/opi"

app:
  s3:
    presign:
      put-expires-seconds: 300
      key-prefix: lms/extra-session-videos
  password-reset:
    link-template: ${PASSWORD_RESET_LINK_TEMPLATE:http://localhost:3000/password-reset?token=%s}
    mail-subject: ${PASSWORD_RESET_MAIL_SUBJECT:Password Reset}
    mail-from: ${PASSWORD_RESET_MAIL_FROM:no-reply@teamlms.local}
    token-ttl-seconds: ${PASSWORD_RESET_TOKEN_TTL_SECONDS:1800}
