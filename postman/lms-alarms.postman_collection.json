{
  "info": {
    "name": "알람",
    "description": "알람 기능 검증용 최소 컬렉션",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {"key": "baseUrl", "value": "http://localhost:8080"},
    {"key": "studentLogin", "value": "s20240001"},
    {"key": "studentPassword", "value": "abc12345"},
    {"key": "professorLogin", "value": "p19990001"},
    {"key": "professorPassword", "value": "abc12345"},
    {"key": "adminLogin", "value": "a20001122"},
    {"key": "adminPassword", "value": "CHANGE_ME"},

    {"key": "studentToken", "value": ""},
    {"key": "professorToken", "value": ""},
    {"key": "adminToken", "value": ""},

    {"key": "noticeCategoryId", "value": ""},
    {"key": "noticeId", "value": ""},
    {"key": "qnaCategoryId", "value": ""},
    {"key": "questionId", "value": ""},
    {"key": "recruitmentId", "value": ""},
    {"key": "mentorApplicationId", "value": ""},
    {"key": "menteeApplicationId", "value": ""},
    {"key": "matchingId", "value": ""},
    {"key": "alarmId", "value": ""}
  ],
  "item": [
    {
      "name": "로그인",
      "item": [
        {
          "name": "학생 로그인",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "url": "{{baseUrl}}/api/v1/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\"loginId\":\"{{studentLogin}}\",\"password\":\"{{studentPassword}}\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "pm.collectionVariables.set('studentToken', json.data.accessToken);"
              ]
            }
          }]
        },
        {
          "name": "교수 로그인",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "url": "{{baseUrl}}/api/v1/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\"loginId\":\"{{professorLogin}}\",\"password\":\"{{professorPassword}}\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "pm.collectionVariables.set('professorToken', json.data.accessToken);"
              ]
            }
          }]
        },
        {
          "name": "관리자 로그인",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "url": "{{baseUrl}}/api/v1/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\"loginId\":\"{{adminLogin}}\",\"password\":\"{{adminPassword}}\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "pm.collectionVariables.set('adminToken', json.data.accessToken);"
              ]
            }
          }]
        }
      ]
    },
    {
      "name": "공지 알람(신규 공지)",
      "item": [
        {
          "name": "공지 카테고리 등록(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/community/notices/categories",
            "body": {
              "mode": "raw",
              "raw": "{\"name\":\"공지\",\"bgColorHex\":\"#111111\",\"textColorHex\":\"#FFFFFF\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "if (json && json.data && json.data.categoryId) pm.collectionVariables.set('noticeCategoryId', json.data.categoryId);"
              ]
            }
          }]
        },
        {
          "name": "공지 등록(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/community/notices",
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "request", "type": "text", "value": "{\"categoryId\":{{noticeCategoryId}},\"title\":\"공지 테스트\",\"content\":\"공지 내용\"}"}
              ]
            }
          }
        },
        {
          "name": "공지 목록 조회(공지 ID 저장)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/community/notices?page=1&size=20"
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "if (json && json.data && json.data.length > 0) pm.collectionVariables.set('noticeId', json.data[0].noticeId);"
              ]
            }
          }]
        }
      ]
    },
    {
      "name": "질문답변 알람(답변 등록)",
      "item": [
        {
          "name": "질문답변 카테고리 등록(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/community/qna/categories",
            "body": {
              "mode": "raw",
              "raw": "{\"name\":\"질문답변\",\"bgColorHex\":\"#222222\",\"textColorHex\":\"#FFFFFF\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "if (json && json.data && json.data.categoryId) pm.collectionVariables.set('qnaCategoryId', json.data.categoryId);"
              ]
            }
          }]
        },
        {
          "name": "질문 등록(학생)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/student/community/qna/questions",
            "body": {
              "mode": "raw",
              "raw": "{\"categoryId\":{{qnaCategoryId}},\"title\":\"질문\",\"content\":\"질문 내용\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "if (json && json.data && json.data.questionId) pm.collectionVariables.set('questionId', json.data.questionId);"
              ]
            }
          }]
        },
        {
          "name": "답변 등록(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/community/qna/questions/{{questionId}}/answer",
            "body": {
              "mode": "raw",
              "raw": "{\"content\":\"답변 내용\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        }
      ]
    },
    {
      "name": "멘토링 알람",
      "item": [
        {
          "name": "멘토링 모집 공고 생성(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/mentoring/recruitments",
            "body": {
              "mode": "raw",
              "raw": "{\"semesterId\":1,\"title\":\"멘토링 모집\",\"description\":\"설명\",\"recruitStartAt\":\"2026-02-11T09:00:00\",\"recruitEndAt\":\"2026-02-20T23:59:59\"}",
              "options": {"raw": {"language": "json"}}
            }
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const text = pm.response.text();",
                "try { pm.collectionVariables.set('recruitmentId', JSON.parse(text)); } catch (e) { pm.collectionVariables.set('recruitmentId', text); }"
              ]
            }
          }]
        },
        {
          "name": "멘티 신청(학생)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/applications",
            "body": {
              "mode": "raw",
              "raw": "{\"recruitmentId\":{{recruitmentId}},\"role\":\"MENTEE\",\"reason\":\"신청\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "멘토 신청(교수)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{professorToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/applications",
            "body": {
              "mode": "raw",
              "raw": "{\"recruitmentId\":{{recruitmentId}},\"role\":\"MENTOR\",\"reason\":\"신청\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "신청 목록 조회(관리자, 신청 ID 저장)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/mentoring/recruitments/{{recruitmentId}}/applications"
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const data = pm.response.json();",
                "const mentor = data.find(x => x.role === 'MENTOR');",
                "const mentee = data.find(x => x.role === 'MENTEE');",
                "if (mentor) pm.collectionVariables.set('mentorApplicationId', mentor.applicationId);",
                "if (mentee) pm.collectionVariables.set('menteeApplicationId', mentee.applicationId);"
              ]
            }
          }]
        },
        {
          "name": "멘토 신청 승인(관리자)",
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/mentoring/applications/{{mentorApplicationId}}/status",
            "body": {
              "mode": "raw",
              "raw": "{\"status\":\"APPROVED\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "멘티 신청 승인(관리자)",
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/mentoring/applications/{{menteeApplicationId}}/status",
            "body": {
              "mode": "raw",
              "raw": "{\"status\":\"APPROVED\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "매칭(관리자)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{adminToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/admin/mentoring/match",
            "body": {
              "mode": "raw",
              "raw": "{\"recruitmentId\":{{recruitmentId}},\"mentorApplicationId\":{{mentorApplicationId}},\"menteeApplicationId\":{{menteeApplicationId}}}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "내 매칭 조회(멘티, 매칭 ID 저장)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/matchings"
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const data = pm.response.json();",
                "if (Array.isArray(data) && data.length > 0) pm.collectionVariables.set('matchingId', data[0].matchingId);"
              ]
            }
          }]
        },
        {
          "name": "질문 등록(멘티)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/questions",
            "body": {
              "mode": "raw",
              "raw": "{\"matchingId\":{{matchingId}},\"content\":\"질문 내용\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        },
        {
          "name": "채팅 조회(질문 ID 저장)",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/matchings/{{matchingId}}/chat"
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const data = pm.response.json();",
                "const q = Array.isArray(data) ? data.find(x => x.type === 'QUESTION') : null;",
                "if (q) pm.collectionVariables.set('questionId', q.id);"
              ]
            }
          }]
        },
        {
          "name": "답변 등록(멘토)",
          "request": {
            "method": "POST",
            "header": [
              {"key": "Content-Type", "value": "application/json"},
              {"key": "Authorization", "value": "Bearer {{professorToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/mentoring/answers",
            "body": {
              "mode": "raw",
              "raw": "{\"questionId\":{{questionId}},\"content\":\"답변 내용\"}",
              "options": {"raw": {"language": "json"}}
            }
          }
        }
      ]
    },
    {
      "name": "알람 조회/읽음",
      "item": [
        {
          "name": "알림 목록 조회",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/alarms?page=1&size=20"
          },
          "event": [{
            "listen": "test",
            "script": {
              "type": "text/javascript",
              "exec": [
                "const json = pm.response.json();",
                "if (json && json.data && json.data.length > 0) pm.collectionVariables.set('alarmId', json.data[0].alarmId);"
              ]
            }
          }]
        },
        {
          "name": "미확인 알림 수",
          "request": {
            "method": "GET",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/alarms/unread-count"
          }
        },
        {
          "name": "알림 읽음 처리",
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/alarms/{{alarmId}}/read"
          }
        },
        {
          "name": "알림 전체 읽음 처리",
          "request": {
            "method": "PATCH",
            "header": [
              {"key": "Authorization", "value": "Bearer {{studentToken}}"}
            ],
            "url": "{{baseUrl}}/api/v1/alarms/read-all"
          }
        }
      ]
    }
  ]
}
